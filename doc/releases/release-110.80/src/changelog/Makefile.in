# Makefile for SML/NJ Changelog
#
# COPYRIGHT (c) 2014 The Fellowship of SML/NJ (http://www.smlnj.org)
# All rights reserved.
#
# @configure_input@
#

SHELL =		@SHELL@
INSTALL =	@INSTALL@
@SET_MAKE@

ASCIIDOC =	@ASCIIDOC@

SMLNJ_VERSION =	@SMLNJ_VERSION@
SMLNJ_DATE =	@SMLNJ_DATE@

HTML_OUT_DIR =	@OUT_DIR@/html
WEB_OUT_DIR =	@WEB_OUT_DIR@

ATTRS =		--attribute=version=$(SMLNJ_VERSION) \
		--attribute=releasedate="$(SMLNJ_DATE)" \
		--attribute=source-highlighter=pygments

CONF =		--conf-file=../conf/HISTORY-html.conf

TXT_FILES =	HISTORY.txt

HTML =		$(TXT_FILES:.txt=.html)

# build rule for generating the distribution documentation
#
.PHONY:	doc
doc:		html
		mkdir -p $(HTML_OUT_DIR)
		cp -p $(HTML) $(HTML_OUT_DIR)

.PHONY:	html
html:		$(HTML)

%.html : %.txt
	$(ASCIIDOC) $(ATTRS) $(CONF) -b html5 $<

#################### Cleanup ####################

CLEAN_SUBDIRS =

CLEAN_FILES =

DISTCLEAN_FILES +=	Makefile \
			$(HTML)

include @ROOT_DIR@/mk/clean-rules.gmk
