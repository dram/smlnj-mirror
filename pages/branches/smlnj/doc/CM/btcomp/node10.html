<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 99.1 release (March 30, 1999)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>3.1 Code sharing</TITLE>
<META NAME="description" CONTENT="3.1 Code sharing">
<META NAME="keywords" CONTENT="btcomp">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v99.1 release">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="btcomp.css">

<LINK REL="next" HREF="node11.html">
<LINK REL="previous" HREF="node9.html">
<LINK REL="up" HREF="node9.html">
<LINK REL="next" HREF="node11.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html187"
 HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html183"
 HREF="node9.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html177"
 HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html185"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html188"
 HREF="node11.html">3.2 Init library</A>
<B> Up:</B> <A NAME="tex2html184"
 HREF="node9.html">3. Differences between CMB</A>
<B> Previous:</B> <A NAME="tex2html178"
 HREF="node9.html">3. Differences between CMB</A>
 &nbsp <B>  <A NAME="tex2html186"
 HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00041000000000000000">
3.1 Code sharing</A>
</H2>

<P>
CM keeps compiled code within the same directory tree that contains
the corresponding ML source code.  Thus, there is a fixed function
that maps the names of source files to the names of corresponding
binfiles and the names of CM description files (for libraries) to
their corresponding stable files.

<P>
As a result, these files will be shared between programs that use the
same libraries.  Moreover, CM will let different programs that are
loaded into an interactive session at the same time share their
in-memory copies of common compiled modules.  (There is also an issue of
state-sharing, but this does not concern CMB because the bootstrap
compiler only compiles code without linking it.)

<P>
Sharing of code is useful for ordinary usage, but when compiling the
compiler itself, it is not desirable.  During bootstrap compilation,
it is often the case that several different versions of compiled code
have to coexist.  Some, or even all of these versions can differ
significantly from those of the currently running system.

<P>
Therefore, CMB keeps binfiles and stable files in separate directory
trees.  The names of the directories where these trees are rooted at
are constructed from three parts; the binfile directory's name is <TT> 
<IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.gif"
 ALT="$u$">.bin.<I> arch</I>-<I> os</I></TT> and the stablefile directory's name is
<TT> <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.gif"
 ALT="$u$">.boot.<I> arch</I>-<I> os</I></TT>.  As mentioned before, <I> arch</I>
is a string describing the current CPU architecture and <I> os</I> is a
string describing the current operating system kind. Component <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.gif"
 ALT="$u$"> is
a string that can be selected freely when the bootstrap compiler is
invoked.  When using <TT> CMB.make</TT> it defaults to <TT> sml</TT>,
otherwise it is the argument given to <TT> CMB.make'</TT>.  (The <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.gif"
 ALT="$u$">
component is kept variable to make it possible to keep and use several
compiled versions of the system at the same time.)

<P>
The auxiliary script <TT> makeml</TT> (which is responsible for
bootstrapping a new system) also accepts a parameters to select <IMG
 WIDTH="13" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.gif"
 ALT="$u$">.
If the parameter is missing, it defaults to <TT> sml</TT> (in accordance
with <TT> CMB.make</TT>'s behavior).

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html187"
 HREF="node11.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html183"
 HREF="node9.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html177"
 HREF="node9.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html185"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html188"
 HREF="node11.html">3.2 Init library</A>
<B> Up:</B> <A NAME="tex2html184"
 HREF="node9.html">3. Differences between CMB</A>
<B> Previous:</B> <A NAME="tex2html178"
 HREF="node9.html">3. Differences between CMB</A>
 &nbsp <B>  <A NAME="tex2html186"
 HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Matthias Blume</I>
<BR><I>2001-07-19</I>
</ADDRESS>
</BODY>
</HTML>
