<!-- HTML/date.html -->

<!-- COPYRIGHT (c) 1997 Bell Labs, Lucent Technologies. -->

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>The Date structure</TITLE>
</HEAD>
<BODY>
<A NAME="top"></A>
<H1 align="CENTER">The Standard ML Basis Library</H1>
<HR>


<H3>The <CODE>Date</CODE> structure</H3>
<P>
The Date structure provides  functions for converting between times and dates, and formatting and scanning dates. 
<HR>
<H4>Synopsis</H4>
<BLOCKQUOTE>
<CODE><B>signature </B><A NAME="DATE:SIG:SPEC"><CODE>DATE</CODE></A><BR>
<B>structure </B><A NAME="Date:STR:SPEC"><CODE>Date</CODE></A><B> : </B>DATE<BR>
</CODE>
</BLOCKQUOTE>
<HR>
<H4>Interface</H4>
<BLOCKQUOTE>
<CODE><B>datatype</B> <A NAME="SIG:DATE.weekday:TY:SPEC" HREF="#SIG:DATE.weekday:TY">weekday</A><BR>
&nbsp;&nbsp;<B>=</B> Mon<BR>
&nbsp;&nbsp;<B>|</B> Tue<BR>
&nbsp;&nbsp;<B>|</B> Wed<BR>
&nbsp;&nbsp;<B>|</B> Thu<BR>
&nbsp;&nbsp;<B>|</B> Fri<BR>
&nbsp;&nbsp;<B>|</B> Sat<BR>
&nbsp;&nbsp;<B>|</B> Sun<BR>
<B>datatype</B> <A NAME="SIG:DATE.month:TY:SPEC" HREF="#SIG:DATE.month:TY">month</A><BR>
&nbsp;&nbsp;<B>=</B> Jan<BR>
&nbsp;&nbsp;<B>|</B> Feb<BR>
&nbsp;&nbsp;<B>|</B> Mar<BR>
&nbsp;&nbsp;<B>|</B> Apr<BR>
&nbsp;&nbsp;<B>|</B> May<BR>
&nbsp;&nbsp;<B>|</B> Jun<BR>
&nbsp;&nbsp;<B>|</B> Jul<BR>
&nbsp;&nbsp;<B>|</B> Aug<BR>
&nbsp;&nbsp;<B>|</B> Sep<BR>
&nbsp;&nbsp;<B>|</B> Oct<BR>
&nbsp;&nbsp;<B>|</B> Nov<BR>
&nbsp;&nbsp;<B>|</B> Dec<BR>
<B>type</B> <A NAME="SIG:DATE.date:TY:SPEC" HREF="#SIG:DATE.date:TY">date</A><BR>
<B>exception</B> <A NAME="SIG:DATE.Date:EXN:SPEC" HREF="#SIG:DATE.Date:EXN">Date</A><BR>
<B>val</B> <A NAME="SIG:DATE.date:VAL:SPEC" HREF="#SIG:DATE.date:VAL">date</A> <B>:</B>         {year : int, month : month, day : int,           hour : int, minute : int, second : int,           offset : Time.time option} -&gt; date       <BR>
<B>val</B> <A NAME="SIG:DATE.year:VAL:SPEC" HREF="#SIG:DATE.year:VAL">year</A> <B>:</B> date -&gt; int       <BR>
<B>val</B> <A NAME="SIG:DATE.month:VAL:SPEC" HREF="#SIG:DATE.year:VAL">month</A> <B>:</B> date -&gt; month       <BR>
<B>val</B> <A NAME="SIG:DATE.day:VAL:SPEC" HREF="#SIG:DATE.year:VAL">day</A> <B>:</B> date -&gt; int       <BR>
<B>val</B> <A NAME="SIG:DATE.hour:VAL:SPEC" HREF="#SIG:DATE.year:VAL">hour</A> <B>:</B> date -&gt; int       <BR>
<B>val</B> <A NAME="SIG:DATE.minute:VAL:SPEC" HREF="#SIG:DATE.year:VAL">minute</A> <B>:</B> date -&gt; int       <BR>
<B>val</B> <A NAME="SIG:DATE.second:VAL:SPEC" HREF="#SIG:DATE.year:VAL">second</A> <B>:</B> date -&gt; int       <BR>
<B>val</B> <A NAME="SIG:DATE.weekDay:VAL:SPEC" HREF="#SIG:DATE.year:VAL">weekDay</A> <B>:</B> date -&gt; weekday       <BR>
<B>val</B> <A NAME="SIG:DATE.yearDay:VAL:SPEC" HREF="#SIG:DATE.year:VAL">yearDay</A> <B>:</B> date -&gt; int       <BR>
<B>val</B> <A NAME="SIG:DATE.offset:VAL:SPEC" HREF="#SIG:DATE.year:VAL">offset</A> <B>:</B> date -&gt; Time.time option       <BR>
<B>val</B> <A NAME="SIG:DATE.isDst:VAL:SPEC" HREF="#SIG:DATE.year:VAL">isDst</A> <B>:</B> date -&gt; bool option       <BR>
<B>val</B> <A NAME="SIG:DATE.localOffset:VAL:SPEC" HREF="#SIG:DATE.localOffset:VAL">localOffset</A> <B>:</B> unit -&gt; Time.time         <BR>
<B>val</B> <A NAME="SIG:DATE.fromTimeLocal:VAL:SPEC" HREF="#SIG:DATE.fromTimeLocal:VAL">fromTimeLocal</A> <B>:</B> Time.time -&gt; date       <BR>
<B>val</B> <A NAME="SIG:DATE.fromTimeUniv:VAL:SPEC" HREF="#SIG:DATE.fromTimeLocal:VAL">fromTimeUniv</A> <B>:</B> Time.time -&gt; date         <BR>
<B>val</B> <A NAME="SIG:DATE.toTime:VAL:SPEC" HREF="#SIG:DATE.toTime:VAL">toTime</A> <B>:</B> date -&gt; Time.time         <BR>
<B>val</B> <A NAME="SIG:DATE.toString:VAL:SPEC" HREF="#SIG:DATE.toString:VAL">toString</A> <B>:</B> date -&gt; string         <BR>
<B>val</B> <A NAME="SIG:DATE.fmt:VAL:SPEC" HREF="#SIG:DATE.toString:VAL">fmt</A> <B>:</B> string -&gt; date -&gt; string         <BR>
<B>val</B> <A NAME="SIG:DATE.fromString:VAL:SPEC" HREF="#SIG:DATE.fromString:VAL">fromString</A> <B>:</B> string -&gt; date option       <BR>
<B>val</B> <A NAME="SIG:DATE.scan:VAL:SPEC" HREF="#SIG:DATE.fromString:VAL">scan</A> <B>:</B> (char, 'a) StringCvt.reader -&gt; 'a -&gt; (date * 'a) option         <BR>
<B>val</B> <A NAME="SIG:DATE.compare:VAL:SPEC" HREF="#SIG:DATE.compare:VAL">compare</A> <B>:</B> (date * date) -&gt; order         <BR>
</CODE>
</BLOCKQUOTE>
<H4>Description</H4>
<DL>
<DT> <A NAME="SIG:DATE.weekday:TY"><CODE><B>datatype</B> weekday</CODE></A>
<DD>
<BR>

<DT> <A NAME="SIG:DATE.month:TY"><CODE><B>datatype</B> month</CODE></A>
<DD>
<BR>

<DT> <A NAME="SIG:DATE.date:TY"><CODE><B>type</B> date</CODE></A>
<DD>
An abstract type whose values represents an instant in a specific time zone.      
<BR>
<BR>

<DT> <A NAME="SIG:DATE.Date:EXN"><CODE><B>exception</B> Date</CODE></A>
<DD>
<BR>

<DT> <A NAME="SIG:DATE.date:VAL"><CODE>date <VAR>date_info</VAR>
          </CODE></A>
<DD>
creates a canonical date from the given date information. If the resulting date is outside the range supported by the implementation, the <A HREF="#SIG:DATE.Date:EXN:SPEC">Date</A> exception is raised.
<P>
Seconds outside the range <CODE>0..59</CODE> are converted to the equivalent minutes and added to the minutes argument. Similar conversions are performed for minutes to  hours, hours to days, days to months, and months to years.  
<P>
The offset argument provides time zone information. A value of <A HREF="option.html#SIG:OPTION.option:TY:SPEC">NONE</A> represents the local time zone.  A value of <CODE>(<A HREF="option.html#SIG:OPTION.option:TY:SPEC">SOME</A> <VAR>t</VAR>)</CODE> corresponds to time <VAR>t</VAR> west of UTC. In particular,  <CODE>(SOME <A HREF="time.html#SIG:TIME.zeroTime:VAL:SPEC">Time.zeroTime</A>)</CODE> is UTC. Offsets outside the range <CODE>0..23</CODE> are added to the hours (before converting excess hours to days).  
<P>
Leap years follow the Gregorian calendar. Leap seconds may or may not be ignored. In an implementation that takes account of leap seconds, the seconds function may return 60 or 61 in the rare cases that this is appropriate.     
<BR>
<BR>

<DT> <A NAME="SIG:DATE.year:VAL"><CODE>year <VAR>date</VAR>
          </CODE></A>
<DT> <CODE>          month <VAR>date</VAR>
          </CODE>
<DT> <CODE>          day <VAR>date</VAR>
          </CODE>
<DT> <CODE>          hour <VAR>date</VAR>
          </CODE>
<DT> <CODE>          minute <VAR>date</VAR>
          </CODE>
<DT> <CODE>          second <VAR>date</VAR>
          </CODE>
<DT> <CODE>          weekDay <VAR>date</VAR>
          </CODE>
<DT> <CODE>          yearDay <VAR>date</VAR>
          </CODE>
<DT> <CODE>          offset <VAR>date</VAR>
          </CODE>
<DT> <CODE>          isDst <VAR>date</VAR>
          </CODE>
<DD>
return attributes of the value <VAR>date</VAR>. The year returned by <A HREF="#SIG:DATE.year:VAL:SPEC">year</A> uses year 0 as its base. Thus, the date Robin Milner received the Turing award would have year 1991. The function <A HREF="#SIG:DATE.yearDay:VAL:SPEC">yearDay</A> returns the day of the year, starting from 0, i.e., 1 January is day 0. The value returned by <CODE><A HREF="#SIG:DATE.offset:VAL:SPEC">offset</A> <VAR>date</VAR></CODE>  reports time zone information as the amount of time west of UTC. A value of  <A HREF="option.html#SIG:OPTION.option:TY:SPEC">NONE</A> represents the local time zone. The function <A HREF="#SIG:DATE.isDst:VAL:SPEC">isDst</A> returns  <A HREF="option.html#SIG:OPTION.option:TY:SPEC">NONE</A> if the system has no information concerning daylight savings time. Otherwise, it returns  <CODE>(<A HREF="option.html#SIG:OPTION.option:TY:SPEC">SOME</A> <VAR>dst</VAR>)</CODE> where <VAR>dst</VAR> is  <CODE>true</CODE> if daylight savings time is in effect.     
<BR>
<BR>

<DT> <A NAME="SIG:DATE.localOffset:VAL"><CODE>localOffset ()
          </CODE></A>
<DD>
returns the offset from UTC for the local time zone.     
<BR>
<BR>

<DT> <A NAME="SIG:DATE.fromTimeLocal:VAL"><CODE>fromTimeLocal <VAR>t</VAR>
          </CODE></A>
<DT> <CODE>          fromUTC <VAR>t</VAR>
          </CODE>
<DD>
return the date for a given (UTC) time. <CODE>fromTimeLocal</CODE> represents the date in the local time zone; it is the analogue of the ISO  C function <CODE>localtime</CODE>. <CODE>fromUTC</CODE> returns the date in the UTC time zone; it is the analogue of the ISO C function <CODE>gmtime</CODE>.
<P>
If these functions are applied to the same time value, the resulting dates will differ by the offset of the local time zone from UTC.     
<BR>
<BR>

<DT> <A NAME="SIG:DATE.toTime:VAL"><CODE>toTime <VAR>date</VAR>
          </CODE></A>
<DD>
returns the time corresponding to the local date <VAR>date</VAR>           in the host system.           It raises <A HREF="#SIG:DATE.Date:EXN:SPEC">Date</A> if the date <VAR>date</VAR>           cannot be represented as a <A HREF="time.html#SIG:TIME.time:TY:SPEC">Time.time</A> value.       
<BR>
<BR>

<DT> <A NAME="SIG:DATE.toString:VAL"><CODE>toString <VAR>date</VAR>
          </CODE></A>
<DT> <CODE>          fmt <VAR>s</VAR> <VAR>date</VAR>
          </CODE>
<DD>
return a string representation the date <VAR>date</VAR>.           The result may be wrong if the date is outside the           representable <A HREF="time.html#SIG:TIME.time:TY:SPEC">Time.time</A> range.            Raises <A HREF="#SIG:DATE.Date:EXN:SPEC">Date</A> if the given date is invalid.           
<P>
          The former returns a 24-character string representing the date <VAR>date</VAR>           in the following format:           
<P>
              <CODE>&quot;Wed Mar 08 19:06:45 1995&quot;</CODE>           
<P>
          The latter formats the date according to the format string           <VAR>s</VAR>, following the semantics of the ISO            C function <CODE>strftime</CODE>. In particular, <A HREF="#SIG:DATE.fmt:VAL:SPEC">fmt</A>           is locale-dependent. The allowed formats are: 
<HR>
<CENTER>
<TABLE ALIGN="CENTER">
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%a
<TD ALIGN="LEFT" VALIGN="TOP">
locale's abbreviated weekday name
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%A
<TD ALIGN="LEFT" VALIGN="TOP">
locale's full weekday name
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%b
<TD ALIGN="LEFT" VALIGN="TOP">
locale's abbreviated month name
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%B
<TD ALIGN="LEFT" VALIGN="TOP">
locale's full month name
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%c
<TD ALIGN="LEFT" VALIGN="TOP">
locale's date and time representation (e.g. Dec  2 06:55:15 1979)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%d
<TD ALIGN="LEFT" VALIGN="TOP">
day of month (01..31)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%H
<TD ALIGN="LEFT" VALIGN="TOP">
hour (00..23)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%I
<TD ALIGN="LEFT" VALIGN="TOP">
hour (01..12)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%j
<TD ALIGN="LEFT" VALIGN="TOP">
day of year (001..366)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%m
<TD ALIGN="LEFT" VALIGN="TOP">
month number (01..12)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%M
<TD ALIGN="LEFT" VALIGN="TOP">
minutes (00..59)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%p
<TD ALIGN="LEFT" VALIGN="TOP">
locale's equivalent of the AM/PM designation
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%S
<TD ALIGN="LEFT" VALIGN="TOP">
seconds (00..61)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%U
<TD ALIGN="LEFT" VALIGN="TOP">
week number of year (00..53), with the first Sunday as the first day of week 01
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%w
<TD ALIGN="LEFT" VALIGN="TOP">
day of week (0..6), with 0 representing Sunday
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%W
<TD ALIGN="LEFT" VALIGN="TOP">
week number of year (00..53), with the first Monday as the first day of week 01
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%x
<TD ALIGN="LEFT" VALIGN="TOP">
locale's appropriate date representation
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%X
<TD ALIGN="LEFT" VALIGN="TOP">
locale's appropriate time representation
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%y
<TD ALIGN="LEFT" VALIGN="TOP">
year of century (00..99)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%Y
<TD ALIGN="LEFT" VALIGN="TOP">
year including century (e.g. 1997)
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%Z
<TD ALIGN="LEFT" VALIGN="TOP">
time zone name or abbreviation, or the empty string if no time zone information exists
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%%
<TD ALIGN="LEFT" VALIGN="TOP">
the percent character
<TR>
<TD ALIGN="LEFT" VALIGN="TOP">
%<VAR>c</VAR>
<TD ALIGN="LEFT" VALIGN="TOP">
the character <VAR>c</VAR>, if <VAR>c</VAR> is not one of the format characters listed above
</TABLE>
</CENTER>
<HR>
        For instance,       <CODE><A HREF="#SIG:DATE.fmt:VAL:SPEC">fmt</A> &quot;%A&quot; <VAR>date</VAR></CODE> returns the full name        of the weekday,        such as <CODE>&quot;Monday&quot;</CODE>, for the given date.       For a full description of the <A HREF="#SIG:DATE.fmt:VAL:SPEC">fmt</A>       syntax, consult a description of <CODE>strftime</CODE>.       Note, however, that unlike <CODE>strftime</CODE>, the behavior of        <A HREF="#SIG:DATE.fmt:VAL:SPEC">fmt</A> is defined for the directive <CODE>%<VAR>c</VAR></CODE>       for any character <I>c</I>.     
<BR>
<BR>

<DT> <A NAME="SIG:DATE.fromString:VAL"><CODE>fromString <VAR>s</VAR>
          </CODE></A>
<DT> <CODE>          scan <VAR>getc</VAR> <VAR>str</VAR>
          </CODE>
<DD>
scans a 24-character date from a character source after ignoring           possible initial whitespace. The format           of the string must be precisely as produced by <A HREF="#SIG:DATE.toString:VAL:SPEC">toString</A>. In particular, the functions do not parse time zone abbreviations.           No check of the consistency of           the date (weekday, date in the month, ...) is performed.           If the scanning fails, <A HREF="option.html#SIG:OPTION.option:TY:SPEC">NONE</A> is returned.           
<P>
          The function <CODE>fromString</CODE> takes a string <VAR>s</VAR> as its source           of characters.           Note that the function <CODE>fromString</CODE> is equivalent to           <CODE><A HREF="string-cvt.html#SIG:STRING_CVT.scanString:VAL:SPEC">StringCvt.scanString</A> scan</CODE>.           
<P>
          The function <CODE>scan</CODE> takes a character           stream reader <VAR>getc</VAR> and a stream <VAR>strm</VAR>.           In case of success, it returns            <CODE><A HREF="option.html#SIG:OPTION.option:TY:SPEC">SOME</A>(<VAR>date</VAR>, <VAR>rst</VAR>)</CODE>,            where <VAR>date</VAR> is the scanned           date and <VAR>rst</VAR> is the remainder of the stream.           The type of <A HREF="#SIG:DATE.scan:VAL:SPEC">scan</A> can also be written as           
<PRE>
            (char, 'a) StringCvt.reader -&gt; (date, 'a) StringCvt.reader
          
</PRE>
     
<BR>
<BR>

<DT> <A NAME="SIG:DATE.compare:VAL"><CODE>compare (<VAR>date1</VAR>, <VAR>date2</VAR>)
          </CODE></A>
<DD>
returns <A HREF="general.html#SIG:GENERAL.order:TY:SPEC">LESS</A>, <A HREF="general.html#SIG:GENERAL.order:TY:SPEC">EQUAL</A>, or <A HREF="general.html#SIG:GENERAL.order:TY:SPEC">GREATER</A>, according           as date <VAR>date1</VAR> precedes, equals, or follows <VAR>date2</VAR> in time.           It lexicographically compares the dates, using the year, month, day, hour, minute and second information, but ignoring the offset and daylight savings time information. It does not detect invalid dates.           
<P>
          In order to compare dates in two different time zones, the user           would have to handle the normalization.   
<BR>
<BR>

</DL>
<HR>
<H4>Discussion</H4>
<P>
In the <CODE>Date</CODE> structure, the time type is used to represent intervals since a fixed reference point.  These times are always measured in Universal Co-ordinated Time (UTC), also known as Greenwich Mean Time. The implementation of time values, however, is system dependent, so time values are not portable across implementations.
<P>
A conforming <CODE>Date</CODE> structure should support date values  ranging from around 1900 to 2200, although they may be inaccurate with respect to daylight savings time outside the range of dates supported by time values. 
<BLOCKQUOTE>
<B>Implementation note:</B><BR>

<P>
Implementations of this structure might use the ISO C <CODE>mktime</CODE> function. Some implementations of this function, when given dates that are out of range, wrap around instead of returning -1. Thus, implementations using <CODE>mktime</CODE> need to check the validity of a date before invoking the function.
</BLOCKQUOTE>
    
<H4>See Also</H4>
<BLOCKQUOTE>
<A HREF="string-cvt.html#StringCvt:STR:SPEC">StringCvt</A>, <A HREF="time.html#Time:STR:SPEC">Time</A>
</BLOCKQUOTE>


<HR>
<CENTER>
<B>[ <A HREF="index-all.html">INDEX</A> | <A HREF="#top">TOP</A>
   | <A HREF="system-chapter.html">Parent</A> | <A HREF="sml-std-basis.html">Root</A>
   ]</B>
</CENTER>
<P>
<I>Last Modified October 5, 1997</I><BR>
<I>Comments to <A HREF="mailto:jhr@research.bell-labs.com">John Reppy.</A></I><BR>

Copyright &copy; 1997 Bell Labs, Lucent Technologies <BR>

<HR>
</BODY>
</HTML>
